@()

@import model._
@import controllers.admin.routes._

@scripts = {
    <script type="text/javascript">

        function updatePage() {
            $.ajax({
                url: "/admin/get_simulator_state",
                success: function(result) {
                    if (result.init && !result.isPaused) {
                        window.location.reload(true);
                    }
                }
            });
        }

        $(document).ready( function(){
            window.setInterval(updatePage, 10000);

            $('#ajax_table_id').dataTable( {
              "columns": [
                { "title": "Name" },
                { "title": "Current Users" },
                { "title": "Max Entries" },
                { "title": "Prize Pool" },
                { "title": "TemplateContestId" },
                { "title": "Competition" },
                { "title": "State" },
                { "title": "" }
              ],
              "iDisplayLength": 100,
              "bProcessing": true,
              "aaSorting": [[ 0, "asc" ]],
              "bServerSide": true,
              "stateSave": true,
              "bJQueryUI": true,
              "sPaginationType": "full_numbers",
              "sAjaxSource": "/admin/contests/ajax"
            });
        })

        function verifyPrizes() {
            $.ajax({
                url: "/admin/contests/verify_prizes"
            });
        }

        function verifyEntryFee() {
            $.ajax({
                url: "/admin/contests/verify_entry_fee"
            });
        }

    </script>
}

@main("Contests - Admin", scripts) {

@if(model.Model.isLocalHostTargetEnvironment()) {
<div style="float: right; margin-right:100px;">
    <button class="btn btn-primary" onclick="verifyPrizes()">Verify Prizes</button>
    <button class="btn btn-primary" onclick="verifyEntryFee()">Verify EntryFee</button>
</div>
}

<h1 class="page-header">Contests</h1>
<div style="float: right; margin-right:100px;">
    <a href="@ContestController.defaultCSV"><button class="btn btn-success">Default CSV</button></a>
</div>
<p>
    @helper.form(action = ContestController.importFromCSV, 'enctype -> "multipart/form-data") {
        <input class="btn btn-primary" type="submit" value="Import from CSV">
        <input type="file" name="csv" style="display: inline;">
    }
</p>

<h2 class="sub-header"></h2>
<div class="table-responsive">
    <table id="ajax_table_id" class="table table-striped"></table>
</div>
}