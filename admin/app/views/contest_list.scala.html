@(contests: List[model.Contest])

@import model._
@import controllers.admin.routes._

@scripts = {
    <script type="text/javascript">

        function updatePage() {
            console.log("reload");
            window.location.reload(true);
        }

        $(document).ready( function(){
            window.setInterval(updatePage, 10000);
        })

    </script>
}


@contest_state(template_contest_id : String) = {
    @if(TemplateContest.isFinished(template_contest_id)) {
        <button class="btn btn-danger" value="@template_contest_id">Finished</button>
    } else {
        @if(TemplateContest.isStarted(template_contest_id)) {
            <button class="btn btn-success" value="@template_contest_id">Live</button>
        } else {
            <button class="btn btn-warning" value="@template_contest_id">Waiting</button>
        }
    }
}

@main("Contests - Admin", scripts) {

<h1 class="page-header">Contests</h1>

<a href="@ContestController.instantiateAll"><button class="btn btn-success">Instantiate</button></a>

<h2 class="sub-header"></h2>
<div class="table-responsive">
    <table id="table_id" class="table table-striped">
        <thead>
        <tr>
            <th>Id</th>
            <th>Name</th>
            <th>Current Users</th>
            <th>Max Entries</th>
            <th>TemplateContestId</th>
            <th>State</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        @for(p <- contests) {
        <tr>
            <td>@p.contestId</td>
            <td><a href="@ContestController.show(p.contestId.toString())">@p.name</a></td>
            <td>@p.contestEntries.size()</td>
            <td>@p.maxEntries</td>
            <td><a href="@TemplateContestController.show(p.templateContestId.toString())">@p.templateContestId</a></td>
            <td>@contest_state(p.templateContestId.toString())</td>
            <td>
                <a href="@ContestEntryController.enterContest(p.contestId.toString())"><button class="btn btn-success">Enter</button></a>
                <a href="@ContestController.destroy(p.contestId.toString())"><button class="btn btn-danger">-</button></a>
            </td>
        </tr>
        }
        </tbody>
    </table>
</div>

}